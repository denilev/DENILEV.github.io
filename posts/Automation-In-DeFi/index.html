<!DOCTYPE html><html lang="ru-RU" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Python. DeFi автоматизация процессов." /><meta name="author" content="Денис" /><meta property="og:locale" content="ru_RU" /><meta name="description" content="Автматизировать и ускорить, задать исполнение по расписанию любому процессу в блокчейне. Любые кнопки нажимаются сами. Быстро купить токен на самом старте продаж. .env Добавляю здесь новый код по мере практики. Общее описание исходного фрагмента кода. Готовим среду для последующего взаимодействия подключаем библиотеки, которые понадобятся явно указываем что будем работать с полигоном (способ получения информации из блокчейна и записи в него) аккаунт приват ключ- из приватного создаём публичный сохраняем в переменную для удобства использования принт пишет тру при успехе подключения Где посмотреть в эксплорере функцию транзакции (что происходит) : клик на хеш, вкладка Overview, Click to see More, Input Data: 1 2 3 4 5 ApeSwap Function: swapExactTokensForETH(uint256 amountIn, uint256 amountOutMin, address[] path, address to, uint256 deadline) *** QuickSwap: Function: swapExactETHForTokens(uint256 amountOutMin, address[] path, address to, uint256 deadline) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 from web3 import Web3 import json import time import os import settings # dotenv polygon_url = &quot;https://rpc-mumbai.matic.today/&quot; web3 = Web3(Web3.HTTPProvider(polygon_url)) privateKey = os.getenv(&quot;PRIVATE_KEY&quot;) account = web3.eth.account.privateKeyToAccount(privateKey) publicKey = account.address web3.eth.defaultAccount = account.address print(web3.isConnected()) while True: # зациклить операцию бесконечно - внизу таймер nonce = web3.eth.getTransactionCount(web3.eth.defaultAccount) myData = &#39;0xd204c45e0000000000000000000000007fee397e3058abced3e4ffa9be84f25506b8964d0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005a68747470733a2f2f676174657761792e70696e6174612e636c6f75642f697066732f516d653857564b795361374e4574555178654353515a774e695a314d72525273636945764b6e7679585a785274702f4173616d692e6a7067000000000000&#39; address = Web3.toChecksumAddress(&#39;0x1C1E0d77dcA2882628545D40aEea86Eb5C3A42D9&#39;) tx = { &#39;from&#39; : publicKey, &#39;nonce&#39; : nonce, &#39;gasPrice&#39; : web3.toWei(35, &#39;gwei&#39;), # GAS: Standard_31.4(Gwei), Fast_36(Gwei) https://polygonscan.com/gastracker &#39;gas&#39; : 1500000, &#39;to&#39; : address, &#39;data&#39; : myData, &#39;chainId&#39;: 80001 # в настройке сети ID цепочки } signed_tx = web3.eth.account.sign_transaction(tx, privateKey) tx_hash = web3.eth.send_raw_transaction(signed_tx.rawTransaction) time.sleep(10*3) # таймаут в цикле, первое число секунды, умноженное на что-то, (10*3)-это 30 секунд. settings.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # settings.py ## importing the load_dotenv from the python-dotenv module from dotenv import load_dotenv ## using existing module to specify location of the .env file from pathlib import Path load_dotenv() env_path = Path(&#39;.&#39;)/&#39;.env&#39; load_dotenv(dotenv_path=env_path) # retrieving keys and adding them to the project # from the .env file through their key names # PRIVATE_KEY = os.getenv(&quot;PRIVATE_KEY&quot;) - пример использования в моём коде .env файл 1 PRIVATE_KEY=*******************************" /><meta property="og:description" content="Автматизировать и ускорить, задать исполнение по расписанию любому процессу в блокчейне. Любые кнопки нажимаются сами. Быстро купить токен на самом старте продаж. .env Добавляю здесь новый код по мере практики. Общее описание исходного фрагмента кода. Готовим среду для последующего взаимодействия подключаем библиотеки, которые понадобятся явно указываем что будем работать с полигоном (способ получения информации из блокчейна и записи в него) аккаунт приват ключ- из приватного создаём публичный сохраняем в переменную для удобства использования принт пишет тру при успехе подключения Где посмотреть в эксплорере функцию транзакции (что происходит) : клик на хеш, вкладка Overview, Click to see More, Input Data: 1 2 3 4 5 ApeSwap Function: swapExactTokensForETH(uint256 amountIn, uint256 amountOutMin, address[] path, address to, uint256 deadline) *** QuickSwap: Function: swapExactETHForTokens(uint256 amountOutMin, address[] path, address to, uint256 deadline) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 from web3 import Web3 import json import time import os import settings # dotenv polygon_url = &quot;https://rpc-mumbai.matic.today/&quot; web3 = Web3(Web3.HTTPProvider(polygon_url)) privateKey = os.getenv(&quot;PRIVATE_KEY&quot;) account = web3.eth.account.privateKeyToAccount(privateKey) publicKey = account.address web3.eth.defaultAccount = account.address print(web3.isConnected()) while True: # зациклить операцию бесконечно - внизу таймер nonce = web3.eth.getTransactionCount(web3.eth.defaultAccount) myData = &#39;0xd204c45e0000000000000000000000007fee397e3058abced3e4ffa9be84f25506b8964d0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005a68747470733a2f2f676174657761792e70696e6174612e636c6f75642f697066732f516d653857564b795361374e4574555178654353515a774e695a314d72525273636945764b6e7679585a785274702f4173616d692e6a7067000000000000&#39; address = Web3.toChecksumAddress(&#39;0x1C1E0d77dcA2882628545D40aEea86Eb5C3A42D9&#39;) tx = { &#39;from&#39; : publicKey, &#39;nonce&#39; : nonce, &#39;gasPrice&#39; : web3.toWei(35, &#39;gwei&#39;), # GAS: Standard_31.4(Gwei), Fast_36(Gwei) https://polygonscan.com/gastracker &#39;gas&#39; : 1500000, &#39;to&#39; : address, &#39;data&#39; : myData, &#39;chainId&#39;: 80001 # в настройке сети ID цепочки } signed_tx = web3.eth.account.sign_transaction(tx, privateKey) tx_hash = web3.eth.send_raw_transaction(signed_tx.rawTransaction) time.sleep(10*3) # таймаут в цикле, первое число секунды, умноженное на что-то, (10*3)-это 30 секунд. settings.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # settings.py ## importing the load_dotenv from the python-dotenv module from dotenv import load_dotenv ## using existing module to specify location of the .env file from pathlib import Path load_dotenv() env_path = Path(&#39;.&#39;)/&#39;.env&#39; load_dotenv(dotenv_path=env_path) # retrieving keys and adding them to the project # from the .env file through their key names # PRIVATE_KEY = os.getenv(&quot;PRIVATE_KEY&quot;) - пример использования в моём коде .env файл 1 PRIVATE_KEY=*******************************" /><link rel="canonical" href="https://denilev.github.io/posts/Automation-In-DeFi/" /><meta property="og:url" content="https://denilev.github.io/posts/Automation-In-DeFi/" /><meta property="og:site_name" content="Anima Sanator" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-17T18:26:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Python. DeFi автоматизация процессов." /><meta name="twitter:site" content="@dinriumi" /><meta name="twitter:creator" content="@Денис" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Денис"},"dateModified":"2022-05-18T11:22:27+03:00","datePublished":"2022-05-17T18:26:00+03:00","description":"Автматизировать и ускорить, задать исполнение по расписанию любому процессу в блокчейне. Любые кнопки нажимаются сами. Быстро купить токен на самом старте продаж. .env Добавляю здесь новый код по мере практики. Общее описание исходного фрагмента кода. Готовим среду для последующего взаимодействия подключаем библиотеки, которые понадобятся явно указываем что будем работать с полигоном (способ получения информации из блокчейна и записи в него) аккаунт приват ключ- из приватного создаём публичный сохраняем в переменную для удобства использования принт пишет тру при успехе подключения Где посмотреть в эксплорере функцию транзакции (что происходит) : клик на хеш, вкладка Overview, Click to see More, Input Data: 1 2 3 4 5 ApeSwap Function: swapExactTokensForETH(uint256 amountIn, uint256 amountOutMin, address[] path, address to, uint256 deadline) *** QuickSwap: Function: swapExactETHForTokens(uint256 amountOutMin, address[] path, address to, uint256 deadline) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 from web3 import Web3 import json import time import os import settings # dotenv polygon_url = &quot;https://rpc-mumbai.matic.today/&quot; web3 = Web3(Web3.HTTPProvider(polygon_url)) privateKey = os.getenv(&quot;PRIVATE_KEY&quot;) account = web3.eth.account.privateKeyToAccount(privateKey) publicKey = account.address web3.eth.defaultAccount = account.address print(web3.isConnected()) while True: # зациклить операцию бесконечно - внизу таймер nonce = web3.eth.getTransactionCount(web3.eth.defaultAccount) myData = &#39;0xd204c45e0000000000000000000000007fee397e3058abced3e4ffa9be84f25506b8964d0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005a68747470733a2f2f676174657761792e70696e6174612e636c6f75642f697066732f516d653857564b795361374e4574555178654353515a774e695a314d72525273636945764b6e7679585a785274702f4173616d692e6a7067000000000000&#39; address = Web3.toChecksumAddress(&#39;0x1C1E0d77dcA2882628545D40aEea86Eb5C3A42D9&#39;) tx = { &#39;from&#39; : publicKey, &#39;nonce&#39; : nonce, &#39;gasPrice&#39; : web3.toWei(35, &#39;gwei&#39;), # GAS: Standard_31.4(Gwei), Fast_36(Gwei) https://polygonscan.com/gastracker &#39;gas&#39; : 1500000, &#39;to&#39; : address, &#39;data&#39; : myData, &#39;chainId&#39;: 80001 # в настройке сети ID цепочки } signed_tx = web3.eth.account.sign_transaction(tx, privateKey) tx_hash = web3.eth.send_raw_transaction(signed_tx.rawTransaction) time.sleep(10*3) # таймаут в цикле, первое число секунды, умноженное на что-то, (10*3)-это 30 секунд. settings.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # settings.py ## importing the load_dotenv from the python-dotenv module from dotenv import load_dotenv ## using existing module to specify location of the .env file from pathlib import Path load_dotenv() env_path = Path(&#39;.&#39;)/&#39;.env&#39; load_dotenv(dotenv_path=env_path) # retrieving keys and adding them to the project # from the .env file through their key names # PRIVATE_KEY = os.getenv(&quot;PRIVATE_KEY&quot;) - пример использования в моём коде .env файл 1 PRIVATE_KEY=*******************************","headline":"Python. DeFi автоматизация процессов.","mainEntityOfPage":{"@type":"WebPage","@id":"https://denilev.github.io/posts/Automation-In-DeFi/"},"url":"https://denilev.github.io/posts/Automation-In-DeFi/"}</script><title>Python. DeFi автоматизация процессов. | Anima Sanator</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Anima Sanator"><meta name="application-name" content="Anima Sanator"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://cdn.jsdelivr.net/gh/denilev/cdn/pic/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Anima Sanator</a></div><div class="site-subtitle font-italic">эффективные техники эволюция жизни</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>ДОМАШНЯЯ</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>КАТЕГОРИИ</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ТЕГИ</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>АРХИВ</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>О САЙТЕ</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/denilev" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/dinriumi" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['otdelproden','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Домашняя </a> </span> <span>Python. DeFi автоматизация процессов.</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Публикация</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Поиск..."> </span> <span id="search-cancel" >Отменить</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 500'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/denilev/cdn/pic/blockchain-python.jpg" class="preview-img bg" alt="Preview Image" width="800" height="500" data-proofer-ignore><h1 data-toc-skip>Python. DeFi автоматизация процессов.</h1><div class="post-meta text-muted"><div> Автор <em> <a href="https://t.me/PolygonDevRussia/4843">Денис</a> </em></div><div class="d-flex"><div> <span> Время публикации <em class="timeago" data-ts="1652801160" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-17 </em> </span> <span> Обновлено <em class="timeago" data-ts="1652862147" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-18 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="350 слов"> <em>1 минут</em> чтения</span></div></div></div><div class="post-content"><p>Автматизировать и ускорить, задать исполнение по расписанию любому процессу в блокчейне. Любые кнопки нажимаются сами. Быстро купить токен на самом старте продаж. .env Добавляю здесь новый код по мере практики.</p><h2 id="общее-описание-исходного-фрагмента-кода"><span class="mr-2">Общее описание исходного фрагмента кода.</span><a href="#общее-описание-исходного-фрагмента-кода" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Готовим среду для последующего взаимодействия</p><ol><li>подключаем библиотеки, которые понадобятся<li>явно указываем что будем работать с полигоном (способ получения информации из блокчейна и записи в него)<li>аккаунт приват ключ- из приватного создаём публичный сохраняем в переменную для удобства использования<li>принт пишет тру при успехе подключения</ol><p>Где посмотреть в эксплорере функцию транзакции (что происходит) : клик на хеш, вкладка Overview, Click to see More, Input Data:</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span data-label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">ApeSwap</span>
<span class="n">Function</span><span class="o">:</span> <span class="n">swapExactTokensForETH</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">amountIn</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amountOutMin</span><span class="p">,</span> <span class="kt">address</span><span class="p">[]</span> <span class="n">path</span><span class="p">,</span> <span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">deadline</span><span class="p">)</span> <span class="o">***</span>

<span class="n">QuickSwap</span><span class="o">:</span>
<span class="n">Function</span><span class="o">:</span> <span class="n">swapExactETHForTokens</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">amountOutMin</span><span class="p">,</span> <span class="kt">address</span><span class="p">[]</span> <span class="n">path</span><span class="p">,</span> <span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">deadline</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">web3</span> <span class="kn">import</span> <span class="n">Web3</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">settings</span> <span class="c1"># dotenv
</span>
<span class="n">polygon_url</span> <span class="o">=</span> <span class="s">"https://rpc-mumbai.matic.today/"</span>
<span class="n">web3</span> <span class="o">=</span> <span class="n">Web3</span><span class="p">(</span><span class="n">Web3</span><span class="p">.</span><span class="n">HTTPProvider</span><span class="p">(</span><span class="n">polygon_url</span><span class="p">))</span>

<span class="n">privateKey</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">"PRIVATE_KEY"</span><span class="p">)</span>
<span class="n">account</span> <span class="o">=</span> <span class="n">web3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">account</span><span class="p">.</span><span class="n">privateKeyToAccount</span><span class="p">(</span><span class="n">privateKey</span><span class="p">)</span>
<span class="n">publicKey</span> <span class="o">=</span> <span class="n">account</span><span class="p">.</span><span class="n">address</span>
<span class="n">web3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">defaultAccount</span> <span class="o">=</span> <span class="n">account</span><span class="p">.</span><span class="n">address</span>

<span class="k">print</span><span class="p">(</span><span class="n">web3</span><span class="p">.</span><span class="n">isConnected</span><span class="p">())</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span> <span class="c1"># зациклить операцию бесконечно - внизу таймер
</span>  <span class="n">nonce</span> <span class="o">=</span> <span class="n">web3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">getTransactionCount</span><span class="p">(</span><span class="n">web3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">defaultAccount</span><span class="p">)</span>
  <span class="n">myData</span> <span class="o">=</span> <span class="s">'0xd204c45e0000000000000000000000007fee397e3058abced3e4ffa9be84f25506b8964d0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005a68747470733a2f2f676174657761792e70696e6174612e636c6f75642f697066732f516d653857564b795361374e4574555178654353515a774e695a314d72525273636945764b6e7679585a785274702f4173616d692e6a7067000000000000'</span>
  <span class="n">address</span> <span class="o">=</span> <span class="n">Web3</span><span class="p">.</span><span class="n">toChecksumAddress</span><span class="p">(</span><span class="s">'0x1C1E0d77dcA2882628545D40aEea86Eb5C3A42D9'</span><span class="p">)</span>

  <span class="n">tx</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'from'</span>  <span class="p">:</span> <span class="n">publicKey</span><span class="p">,</span>
    <span class="s">'nonce'</span> <span class="p">:</span> <span class="n">nonce</span><span class="p">,</span>
    <span class="s">'gasPrice'</span> <span class="p">:</span> <span class="n">web3</span><span class="p">.</span><span class="n">toWei</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="s">'gwei'</span><span class="p">),</span> <span class="c1"># GAS: Standard_31.4(Gwei), Fast_36(Gwei) https://polygonscan.com/gastracker
</span>    <span class="s">'gas'</span>  <span class="p">:</span> <span class="mi">1500000</span><span class="p">,</span>
    <span class="s">'to'</span> <span class="p">:</span> <span class="n">address</span><span class="p">,</span>
    <span class="s">'data'</span> <span class="p">:</span> <span class="n">myData</span><span class="p">,</span>
    <span class="s">'chainId'</span><span class="p">:</span> <span class="mi">80001</span> <span class="c1"># в настройке сети ID цепочки
</span>  <span class="p">}</span>

  <span class="n">signed_tx</span> <span class="o">=</span> <span class="n">web3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">account</span><span class="p">.</span><span class="n">sign_transaction</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">privateKey</span><span class="p">)</span>
  <span class="n">tx_hash</span> <span class="o">=</span> <span class="n">web3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">send_raw_transaction</span><span class="p">(</span><span class="n">signed_tx</span><span class="p">.</span><span class="n">rawTransaction</span><span class="p">)</span>
  <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># таймаут в цикле, первое число секунды, умноженное на что-то, (10*3)-это 30 секунд.
</span></pre></table></code></div></div><h3 id="settingspy"><span class="mr-2">settings.py</span><a href="#settingspy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># settings.py
## importing the load_dotenv from the python-dotenv module
</span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="c1">## using existing module to specify location of the .env file
</span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">load_dotenv</span><span class="p">()</span>
<span class="n">env_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span><span class="o">/</span><span class="s">'.env'</span>
<span class="n">load_dotenv</span><span class="p">(</span><span class="n">dotenv_path</span><span class="o">=</span><span class="n">env_path</span><span class="p">)</span>

<span class="c1"># retrieving keys and adding them to the project
# from the .env file through their key names
# PRIVATE_KEY = os.getenv("PRIVATE_KEY") - пример использования в моём коде 
</span></pre></table></code></div></div><h3 id="env-файл"><span class="mr-2">.env файл</span><a href="#env-файл" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">PRIVATE_KEY</span><span class="o">=*******************************</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%D0%B1%D0%BB%D0%BE%D0%BA%D1%87%D0%B5%D0%B9%D0%BD/'>Блокчейн</a>, <a href='/categories/python/'>Python</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/" class="post-tag no-text-decoration" >Автоматизация</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Публикация защищена лицензией <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> .</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Поделиться</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Python. DeFi автоматизация процессов. - Anima Sanator&amp;url=https://denilev.github.io/posts/Automation-In-DeFi/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Python. DeFi автоматизация процессов. - Anima Sanator&amp;u=https://denilev.github.io/posts/Automation-In-DeFi/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://denilev.github.io/posts/Automation-In-DeFi/&amp;text=Python. DeFi автоматизация процессов. - Anima Sanator" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Скопировать ссылку" data-title-succeed="Ссылка успешно скопирована!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Недавно обновлено</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Dilts-Pyramid/">Пирамида логических уровней Роберта Дилтса.</a><li><a href="/posts/write-a-new-post/">Как Писать Новый Пост</a><li><a href="/posts/Automation-In-DeFi/">Python. DeFi автоматизация процессов.</a><li><a href="/posts/HardHat-Networks-Configuration/">Настройка сетей для HardHat. Polygon, Rinkeby, Mumbai, ...</a><li><a href="/posts/text-and-typography/">Текст и Типографика</a></ul></div><div id="access-tags"><div class="panel-heading">Популярные теги</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%D0%BE%D1%81%D0%BE%D0%B7%D0%BD%D0%B0%D0%BD%D0%B8%D0%B5/">осознание</a> <a class="post-tag" href="/tags/contracts/">contracts</a> <a class="post-tag" href="/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/">Автоматизация</a> <a class="post-tag" href="/tags/%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5/">написание</a> <a class="post-tag" href="/tags/%D1%80%D0%B0%D0%B1%D0%BE%D1%87%D0%B0%D1%8F-%D1%81%D1%80%D0%B5%D0%B4%D0%B0/">рабочая среда</a> <a class="post-tag" href="/tags/%D1%82%D0%B8%D0%BF%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D0%BA%D0%B0/">типографика</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Содержание</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Вам также может быть интересно</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Dilts-Pyramid/"><div class="card-body"> <em class="timeago small" data-ts="1652854200" > 2022-05-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Пирамида логических уровней Роберта Дилтса.</h3><div class="text-muted small"><p> Пирамида Дилтса является одной из важнейших моделей НЛП и коучинга. Она показывает то, каким образом наши представления о себе, ценности и убеждения оказывают непосредственное влияние на наши пост...</p></div></div></a></div><div class="card"> <a href="/posts/NFT-Contract-10000/"><div class="card-body"> <em class="timeago small" data-ts="1652035800" > 2022-05-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Загрузить 10000 NFT в IPFS</h3><div class="text-muted small"><p> Контракт по запуску множества NFT с гибкой настройкой параметров. HashLips Код контракта NFT.sol // SPDX-License-Identifier: GPL-3.0 // My revision of HashLips code /** These contracts have...</p></div></div></a></div><div class="card"> <a href="/posts/HardHat-Networks-Configuration/"><div class="card-body"> <em class="timeago small" data-ts="1652035800" > 2022-05-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Настройка сетей для HardHat. Polygon, Rinkeby, Mumbai, ...</h3><div class="text-muted small"><p> Копии файлов HardHat hardhat.config.ts для быстрой настройки различных сетей. +Основные комманды консоли для компиляции, деплоя, верификации, очистки. Mumbai hardhat.config.ts import * as dotenv...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/NFT-Contract-10000/" class="btn btn-outline-primary" prompt="Следующая публикация"><p>Загрузить 10000 NFT в IPFS</p></a> <a href="/posts/Dilts-Pyramid/" class="btn btn-outline-primary" prompt="Предыдущая публикация"><p>Пирамида логических уровней Роберта Дилтса.</p></a></div><script src="https://utteranc.es/client.js" repo="denilev/comments" issue-term="title" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">ДенисоиД</a>. <span data-toggle="tooltip" data-placement="top" title="Публикации на сайте защищены лицензией Creative Commons Attribution 4.0 International (CC BY 4.0), если в тексте публикации не указано иное.">Некоторые права защищены.</span></p></div><div class="footer-right"><p class="mb-0"> Работает на <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Популярные теги</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%D0%BE%D1%81%D0%BE%D0%B7%D0%BD%D0%B0%D0%BD%D0%B8%D0%B5/">осознание</a> <a class="post-tag" href="/tags/contracts/">contracts</a> <a class="post-tag" href="/tags/%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/">Автоматизация</a> <a class="post-tag" href="/tags/%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5/">написание</a> <a class="post-tag" href="/tags/%D1%80%D0%B0%D0%B1%D0%BE%D1%87%D0%B0%D1%8F-%D1%81%D1%80%D0%B5%D0%B4%D0%B0/">рабочая среда</a> <a class="post-tag" href="/tags/%D1%82%D0%B8%D0%BF%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D0%BA%D0%B0/">типографика</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Ох! Ничего не найдено.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ru.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
